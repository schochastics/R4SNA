{
  "hash": "cdbda52df48c7f2a69ec3c81ef11aea1",
  "result": {
    "engine": "knitr",
    "markdown": "# Two-Mode Networks\n\nA **two-mode network** is a network that consists of two disjoint sets of nodes (like people and events). Ties connect the two sets, for example participation of people in events. Other examples are \n\n- Affiliation networks (Membership in institutions/clubs)\n- Voting/Sponsorship networks (politicians and bills)\n- Citation network (authors and papers)\n- Co-Authorship networks (also authors and papers)\n\nThere are two ways of analysing a two-mode network. Either directly by using methods specifically created for such networks, or by projecting it to a regular one-mode network [@everett2013dual]. The advantage of the former is that there is no information loss and the advantage of the latter is that we are working with more familiar data structures. The projection approach is more popular these days, but we will still introduce some direct methods to analyse two-mode networks. The main part of this chapter will however deal with the projection approach.\n\n\n## Packages Needed for this Chapter\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(igraph)\nlibrary(networkdata)\nlibrary(tnet)\nlibrary(backbone)\n```\n:::\n\n\n\n\n## Two-Mode Data Structure\nTwo-mode network data (also called bipartite network data) represent relationships between two distinct types of entities rather than ties among members of a single set. Typical examples include individuals and organizations, students and courses, or authors and publications. Instead of being represented as a standard actor-by-actor adjacency matrix, two-mode networks are stored as an **incidence matrix** or **biadjacency matrix**, in which rows represent one type of node (e.g., individuals) and columns represent the other type (e.g., events or organizations). The entries in the matrix indicate whether a tie exists across the two sets—for instance, whether a person attended an event or belongs to an organization. This incidence matrix structure makes it possible to analyze affiliation patterns, shared participation, and broader forms of social or institutional embeddedness.\n\nTwo-mode networks are especially useful for analyzing how connections emerge indirectly, for example, when two individuals are linked because they attend the same event or belong to the same organization.\n\nTo illustrate methods tailored for two-mode networks, we will use the well-known *Southern Women* dataset [@davis2009deep]. This classic dataset records the attendance patterns of 18 women at 14 social events in the American South, and has become a foundational example in network analysis.  The network is included in the `networkdata` package and provides a canonical example of an affiliation (incidence) matrix suitable for demonstrating two-mode network methods and one-mode projections. \nThe biadjacency matrix and can be obtained via `as_biadjacency_matrix()`. This matrix is visualized in @fig-incmat. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"southern_women\")\nsouthern_women\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nIGRAPH 1074643 UN-B 32 89 -- \n+ attr: type (v/l), name (v/c)\n+ edges from 1074643 (vertex names):\n [1] EVELYN   --6/27 EVELYN   --3/2  EVELYN   --4/12 EVELYN   --9/26\n [5] EVELYN   --2/25 EVELYN   --5/19 EVELYN   --9/16 EVELYN   --4/8 \n [9] LAURA    --6/27 LAURA    --3/2  LAURA    --4/12 LAURA    --2/25\n[13] LAURA    --5/19 LAURA    --3/15 LAURA    --9/16 THERESA  --3/2 \n[17] THERESA  --4/12 THERESA  --9/26 THERESA  --2/25 THERESA  --5/19\n[21] THERESA  --3/15 THERESA  --9/16 THERESA  --4/8  BRENDA   --6/27\n[25] BRENDA   --4/12 BRENDA   --9/26 BRENDA   --2/25 BRENDA   --5/19\n[29] BRENDA   --3/15 BRENDA   --9/16 CHARLOTTE--4/12 CHARLOTTE--9/26\n+ ... omitted several edges\n```\n\n\n:::\n\n```{.r .cell-code}\n# get biadjacency matrix\nA <- as_biadjacency_matrix(southern_women)\nA\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          6/27 3/2 4/12 9/26 2/25 5/19 3/15 9/16 4/8 6/10 2/23 4/7 11/21 8/3\nEVELYN       1   1    1    1    1    1    0    1   1    0    0   0     0   0\nLAURA        1   1    1    0    1    1    1    1   0    0    0   0     0   0\nTHERESA      0   1    1    1    1    1    1    1   1    0    0   0     0   0\nBRENDA       1   0    1    1    1    1    1    1   0    0    0   0     0   0\nCHARLOTTE    0   0    1    1    1    0    1    0   0    0    0   0     0   0\nFRANCES      0   0    1    0    1    1    0    1   0    0    0   0     0   0\nELEANOR      0   0    0    0    1    1    1    1   0    0    0   0     0   0\nPEARL        0   0    0    0    0    1    0    1   1    0    0   0     0   0\nRUTH         0   0    0    0    1    0    1    1   1    0    0   0     0   0\nVERNE        0   0    0    0    0    0    1    1   1    0    0   1     0   0\nMYRNA        0   0    0    0    0    0    0    1   1    1    0   1     0   0\nKATHERINE    0   0    0    0    0    0    0    1   1    1    0   1     1   1\nSYLVIA       0   0    0    0    0    0    1    1   1    1    0   1     1   1\nNORA         0   0    0    0    0    1    1    0   1    1    1   1     1   1\nHELEN        0   0    0    0    0    0    1    1   0    1    1   1     0   0\nDOROTHY      0   0    0    0    0    0    0    1   1    0    0   0     0   0\nOLIVIA       0   0    0    0    0    0    0    0   1    0    1   0     0   0\nFLORA        0   0    0    0    0    0    0    0   1    0    1   0     0   0\n```\n\n\n:::\n:::\n\n\n::: {#fig-incmat}\n\n::: {.cell}\n::: {.cell-output-display}\n![](two-mode-networks_files/figure-html/southern-dat-mat-plot-1.png){width=672}\n:::\n:::\n\nIncidence matrix representation of the Southern Women two-mode network. Rows correspond to the 18 women and columns to the 14 social events; black cells indicate attendance at an event, and white cells indicate non-attendance. The block structure visible in the matrix reflects patterns of shared participation that later analyses identify as cohesive subgroups and overlapping social circles within the community.\n\n::: \n\nIn `igraph`, a graph is recognized as a two-mode (bipartite) network when its vertices contain a logical attribute named `type`. This attribute distinguishes the two node sets: typically, one mode is coded as `FALSE` and the other as `TRUE`. Rather than relying on separate data structures, `igraph` uses this vertex-level attribute to determine how functions for bipartite graphs, such as projections or incidence matrix extraction, should behave.\n\nWe can inspect how many vertices belong to each mode using:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(V(southern_women)$type)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nFALSE  TRUE \n   18    14 \n```\n\n\n:::\n:::\n\n\n\nThe logical `type` attribute is also used directly in visualization. Because `igraph` stores information about which nodes belong to which mode, we can map this attribute to visual aesthetics in `ggraph`. In the plot below, `type` determines both the shape and fill color of the nodes, allowing us to clearly distinguish between women and events in the bipartite network.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggraph(southern_women, \"stress\") +\n  geom_edge_link(edge_color = \"grey66\") +\n  geom_node_point(\n    aes(fill = type, shape = type),\n    size = 8,\n    show.legend = FALSE\n  ) +\n  geom_node_text(aes(label = name)) +\n  scale_shape_manual(values = c(21, 22)) +\n  theme_void()\n```\n\n::: {.cell-output-display}\n![](two-mode-networks_files/figure-html/southern-women-plot-1.png){width=864}\n:::\n:::\n\n\nIn the following sections, we will examine both analytical strategies introduced above. First, we briefly consider direct approaches that analyze the two-mode (incidence) structure without transforming it, thereby preserving the full information contained in the bipartite network. We then turn to the more commonly used projection approach, in which the two-mode network is converted into one-mode networks (e.g., women-to-women or event-to-event). While projections rely on more familiar network representations and measures, they inevitably involve some information loss. For this reason, we introduce both perspectives, though the main focus of this chapter will be on the projection-based analysis.\n\n## Direct Approach\nSeveral packages provide methods for analyzing two-mode networks directly, without first projecting them into one-mode structures. In particular, the `tnet` and `bipartite` packages extend familiar one-mode concepts (such as clustering or centrality) to bipartite settings.\n\nFor example, recall that the standard (one-mode) clustering coefficient is based on counting triangles, i.e. closed triplets of nodes. However, triangles cannot exist in a two-mode network because ties only occur between the two distinct node sets (e.g., women $\\leftrightarrow$ events), not within them. This means the usual definition of transitivity must be adapted [@opsahl2013triadic].\n\nIf we naively apply `igraph`’s transitivity function to the bipartite graph, it will return zero (or undefined local values), precisely because triangles are structurally impossible:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntransitivity(southern_women)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n\n```{.r .cell-code}\ntransitivity(southern_women, type = \"local\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   EVELYN     LAURA   THERESA    BRENDA CHARLOTTE   FRANCES   ELEANOR     PEARL \n        0         0         0         0         0         0         0         0 \n     RUTH     VERNE     MYRNA KATHERINE    SYLVIA      NORA     HELEN   DOROTHY \n        0         0         0         0         0         0         0         0 \n   OLIVIA     FLORA      6/27       3/2      4/12      9/26      2/25      5/19 \n        0         0         0         0         0         0         0         0 \n     3/15      9/16       4/8      6/10      2/23       4/7     11/21       8/3 \n        0         0         0         0         0         0         0         0 \n```\n\n\n:::\n:::\n\nTo address this limitation, the `tnet` package defines a two-mode clustering coefficient based on cycles of length six, which involve three nodes from each mode (e.g., woman $\\rightarrow$ event  $\\rightarrow$  woman  $\\rightarrow$  event  $\\rightarrow$  woman  $\\rightarrow$  event  $\\rightarrow$  back to the first woman). These six-step cycles are the bipartite analogue of triangles in one-mode networks.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tnet)\n\nel_women <- as_edgelist(southern_women, names = FALSE)\n\nclustering_tm(el_women)              # global clustering (first mode)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.7718968\n```\n\n\n:::\n\n```{.r .cell-code}\nclustering_local_tm(el_women)        # local clustering (first mode)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   node        lc\n1     1 0.7666667\n2     2 0.8421751\n3     3 0.7523437\n4     4 0.8387909\n5     5 1.0000000\n6     6 0.8690476\n7     7 0.7959184\n8     8 0.6462585\n9     9 0.6702509\n10   10 0.6740891\n11   11 0.7138810\n12   12 0.7695560\n13   13 0.7461929\n14   14 0.8379501\n15   15 0.8159204\n16   16 0.5407407\n17   17 0.5806452\n18   18 0.5806452\n```\n\n\n:::\n\n```{.r .cell-code}\nclustering_local_tm(el_women[,2:1])  # local clustering (second mode)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   node        lc\n1     1       NaN\n2     2       NaN\n3     3       NaN\n4     4       NaN\n5     5       NaN\n6     6       NaN\n7     7       NaN\n8     8       NaN\n9     9       NaN\n10   10       NaN\n11   11       NaN\n12   12       NaN\n13   13       NaN\n14   14       NaN\n15   15       NaN\n16   16       NaN\n17   17       NaN\n18   18       NaN\n19   19 1.0000000\n20   20 0.9487179\n21   21 0.9532967\n22   22 0.9644970\n23   23 0.9628253\n24   24 0.8135593\n25   25 0.7171825\n26   26 0.7791580\n27   27 0.7353630\n28   28 0.8544601\n29   29 0.9555556\n30   30 0.8844765\n31   31 0.8709677\n32   32 0.8709677\n```\n\n\n:::\n:::\n\nThe `NaN` values indicate that for those nodes the two-mode clustering coefficient is undefined, because they do not participate in any valid six-cycle (the bipartite equivalent of a triangle).\n\nBecause counting such six-cycles is computationally intensive, these measures are best applied to relatively small networks. The `tnet` package includes additional two-mode–specific functions (look for `*_tm()`), though in many cases similar insights can be obtained via standard igraph tools\n\nThe `bipartite` package is tailored towards ecological network analysis. Relevant functions for standard two-mode networks are the same as in `tnet`.\n\n\n## Projection Approach\nAn alternative to analyzing a two-mode network directly is to transform it into a one-mode network through **projection**. In a projection, nodes from one mode are connected if they share ties to the same nodes in the other mode. For example, in the *Southern Women* network, two women are connected if they attended at least one common event. Projections can be constructed in either a weighted or binary form. \n\n\n### Weighted Projection\nThis operation is performed using matrix multiplication on the incidence matrix $A$. Projecting onto the first mode (e.g., women) is obtained by computing $AA^T$, while projecting onto the second mode (e.g., events) is obtained via $A^TA$. The resulting matrix is a weighted adjacency matrix, where entries indicate the number of shared affiliations between pairs of nodes.\n\nAs an illustration, we project the Southern Women incidence matrix onto the women:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nB <- A %*% t(A)\nB\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          EVELYN LAURA THERESA BRENDA CHARLOTTE FRANCES ELEANOR PEARL RUTH\nEVELYN         8     6       7      6         3       4       3     3    3\nLAURA          6     7       6      6         3       4       4     2    3\nTHERESA        7     6       8      6         4       4       4     3    4\nBRENDA         6     6       6      7         4       4       4     2    3\nCHARLOTTE      3     3       4      4         4       2       2     0    2\nFRANCES        4     4       4      4         2       4       3     2    2\nELEANOR        3     4       4      4         2       3       4     2    3\nPEARL          3     2       3      2         0       2       2     3    2\nRUTH           3     3       4      3         2       2       3     2    4\nVERNE          2     2       3      2         1       1       2     2    3\nMYRNA          2     1       2      1         0       1       1     2    2\nKATHERINE      2     1       2      1         0       1       1     2    2\nSYLVIA         2     2       3      2         1       1       2     2    3\nNORA           2     2       3      2         1       1       2     2    2\nHELEN          1     2       2      2         1       1       2     1    2\nDOROTHY        2     1       2      1         0       1       1     2    2\nOLIVIA         1     0       1      0         0       0       0     1    1\nFLORA          1     0       1      0         0       0       0     1    1\n          VERNE MYRNA KATHERINE SYLVIA NORA HELEN DOROTHY OLIVIA FLORA\nEVELYN        2     2         2      2    2     1       2      1     1\nLAURA         2     1         1      2    2     2       1      0     0\nTHERESA       3     2         2      3    3     2       2      1     1\nBRENDA        2     1         1      2    2     2       1      0     0\nCHARLOTTE     1     0         0      1    1     1       0      0     0\nFRANCES       1     1         1      1    1     1       1      0     0\nELEANOR       2     1         1      2    2     2       1      0     0\nPEARL         2     2         2      2    2     1       2      1     1\nRUTH          3     2         2      3    2     2       2      1     1\nVERNE         4     3         3      4    3     3       2      1     1\nMYRNA         3     4         4      4    3     3       2      1     1\nKATHERINE     3     4         6      6    5     3       2      1     1\nSYLVIA        4     4         6      7    6     4       2      1     1\nNORA          3     3         5      6    8     4       1      2     2\nHELEN         3     3         3      4    4     5       1      1     1\nDOROTHY       2     2         2      2    1     1       2      1     1\nOLIVIA        1     1         1      1    2     1       1      2     2\nFLORA         1     1         1      1    2     1       1      2     2\n```\n\n\n:::\n:::\n\n\nThis matrix can now be interpreted as a weighted network among the 18 women. Each entry corresponds to the number of times two women went to the same event.\n\nWe can obtain the same projections directly from the bipartite `igraph` object using `bipartite_projection()`, which returns both one-mode projections (women–women and event–event):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprojs <- bipartite_projection(southern_women)\nprojs\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$proj1\nIGRAPH 511fd1b UNW- 18 139 -- \n+ attr: name (v/c), weight (e/n)\n+ edges from 511fd1b (vertex names):\n [1] EVELYN --LAURA     EVELYN --BRENDA    EVELYN --THERESA   EVELYN --CHARLOTTE\n [5] EVELYN --FRANCES   EVELYN --ELEANOR   EVELYN --RUTH      EVELYN --PEARL    \n [9] EVELYN --NORA      EVELYN --VERNE     EVELYN --MYRNA     EVELYN --KATHERINE\n[13] EVELYN --SYLVIA    EVELYN --HELEN     EVELYN --DOROTHY   EVELYN --OLIVIA   \n[17] EVELYN --FLORA     LAURA  --BRENDA    LAURA  --THERESA   LAURA  --CHARLOTTE\n[21] LAURA  --FRANCES   LAURA  --ELEANOR   LAURA  --RUTH      LAURA  --PEARL    \n[25] LAURA  --NORA      LAURA  --VERNE     LAURA  --SYLVIA    LAURA  --HELEN    \n[29] LAURA  --MYRNA     LAURA  --KATHERINE LAURA  --DOROTHY   THERESA--BRENDA   \n+ ... omitted several edges\n\n$proj2\nIGRAPH f54caa5 UNW- 14 66 -- \n+ attr: name (v/c), weight (e/n)\n+ edges from f54caa5 (vertex names):\n [1] 6/27--3/2   6/27--4/12  6/27--9/26  6/27--2/25  6/27--5/19  6/27--9/16 \n [7] 6/27--4/8   6/27--3/15  3/2 --4/12  3/2 --9/26  3/2 --2/25  3/2 --5/19 \n[13] 3/2 --9/16  3/2 --4/8   3/2 --3/15  4/12--9/26  4/12--2/25  4/12--5/19 \n[19] 4/12--9/16  4/12--4/8   4/12--3/15  9/26--2/25  9/26--5/19  9/26--9/16 \n[25] 9/26--4/8   9/26--3/15  2/25--5/19  2/25--9/16  2/25--4/8   2/25--3/15 \n[31] 5/19--9/16  5/19--4/8   5/19--3/15  5/19--6/10  5/19--2/23  5/19--4/7  \n[37] 5/19--11/21 5/19--8/3   3/15--9/16  3/15--4/8   3/15--4/7   3/15--6/10 \n[43] 3/15--11/21 3/15--8/3   3/15--2/23  9/16--4/8   9/16--4/7   9/16--6/10 \n+ ... omitted several edges\n```\n\n\n:::\n:::\n\nTo visualize the weighted women–women projection, we convert $B$ into an `igraph` object and plot it, scaling edge widths by the tie weights:\n\n::: {.cell}\n\n```{.r .cell-code}\nproj <- graph_from_adjacency_matrix(\n  B,\n  weighted = TRUE,\n  diag = FALSE,\n  mode = \"undirected\"\n)\n\nggraph(proj, \"stress\") +\n  geom_edge_link(\n    aes(edge_linewidth = weight),\n    edge_color = \"grey66\",\n    show.legend = FALSE\n  ) +\n  geom_node_point(shape = 21, fill = \"grey66\", size = 8, show.legend = FALSE) +\n  geom_node_text(aes(label = name)) +\n  scale_edge_width(range = c(1, 4)) +\n  theme_void() +\n  coord_cartesian(clip = \"off\")\n```\n\n::: {.cell-output-display}\n![](two-mode-networks_files/figure-html/plot_weighted_proj-1.png){width=960}\n:::\n:::\n\n\nAs the plot makes clear, the projected network is both weighted and typically very dense, since many pairs of women share at least one event. While it is possible to analyze this weighted projection as-is, a common next step is to binarize the projection, treating any positive weight as a tie (1) and zero as no tie (0). This transforms the projection into a simple undirected one-mode network, making the standard tools from earlier sections directly applicable (at least in theory).\n\n### Simple Binary Projections\nThe simplest way to binarize a weighted projection is to define a global threshold and remove all ties whose weights fall below that threshold. A commonly used benchmark is the mean edge weight, sometimes adjusted upward by adding one or two standard deviations.\n\nThe rationale for using the mean (or the mean plus 1–2 standard deviations) is statistical and substantive. In many projected networks, especially those derived from affiliation data, the distribution of edge weights is highly skewed: most pairs share only one or two affiliations, while a smaller number share many. Using the mean as a cutoff removes very weak and potentially incidental connections. Adding one or two standard deviations makes the criterion stricter, retaining only ties that are substantially stronger than average. In effect, this approach filters out background noise and highlights particularly cohesive relationships.\n\nHowever, this choice is heuristic rather than theoretically mandated. The appropriate threshold depends on the research question: lower thresholds preserve more information but may produce very dense graphs, while higher thresholds emphasize strong ties but risk discarding meaningful structure. Consequently, it is often useful to explore how results change across different threshold values.\n\n\nIn the following code, we binarize the weighted women–women projection using the mean edge weight as a global threshold. First, we extract the women’s projection from the list returned by `bipartite_projection()`. We then compute the mean of the edge weights and remove all ties whose weights are less than or equal to this threshold. Finally, we delete the `weight` attribute so that the resulting graph is treated as a simple unweighted (binary) network.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwomen_proj <- projs$proj1\nthreshold <- mean(E(projs$proj1)$weight)\nwomen_bin <- delete_edges(women_proj, which(E(women_proj)$weight <= threshold))\nwomen_bin <- delete_edge_attr(women_bin, \"weight\")\nwomen_bin\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nIGRAPH e3ac565 UN-- 18 46 -- \n+ attr: name (v/c)\n+ edges from e3ac565 (vertex names):\n [1] EVELYN --LAURA     EVELYN --BRENDA    EVELYN --THERESA   EVELYN --CHARLOTTE\n [5] EVELYN --FRANCES   EVELYN --ELEANOR   EVELYN --RUTH      EVELYN --PEARL    \n [9] LAURA  --BRENDA    LAURA  --THERESA   LAURA  --CHARLOTTE LAURA  --FRANCES  \n[13] LAURA  --ELEANOR   LAURA  --RUTH      THERESA--BRENDA    THERESA--CHARLOTTE\n[17] THERESA--FRANCES   THERESA--ELEANOR   THERESA--RUTH      THERESA--PEARL    \n[21] THERESA--NORA      THERESA--VERNE     THERESA--SYLVIA    BRENDA --CHARLOTTE\n[25] BRENDA --FRANCES   BRENDA --ELEANOR   BRENDA --RUTH      FRANCES--ELEANOR  \n[29] ELEANOR--RUTH      RUTH   --VERNE     RUTH   --SYLVIA    VERNE  --SYLVIA   \n+ ... omitted several edges\n```\n\n\n:::\n:::\n\nThe resulting object, `women_bin`, is now a binary one-mode network in which only stronger-than-average shared-event ties are retained. In other words, two women are connected only if they attended more events together than the average pair.\n\nThe plot below visualizes this thresholded projection. Compared to the fully weighted projection, the network is noticeably sparser, highlighting more cohesive and substantively stronger connections while filtering out weaker, potentially incidental overlaps.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggraph(women_bin, \"stress\", bbox = 5) +\n  geom_edge_link(edge_color = \"grey66\") +\n  geom_node_point(shape = 21, fill = \"grey66\", size = 8) +\n  geom_node_text(aes(label = name)) +\n  theme_void() +\n  coord_cartesian(clip = \"off\")\n```\n\n::: {.cell-output-display}\n![](two-mode-networks_files/figure-html/southern-women-bin-plot-1.png){width=1056}\n:::\n:::\n\n\n### Model-based Binary Projections\nThe global threshold method is very simple but in many cases leads to undesirable structural features. More sophisticated tools work with statistical models in the background [@neal2014backbone] which determine if an edge weight differs enough from the expected value of an underlying null model. If so, the edge is kept in the binary projection. Many of such models are implemented in the `backbone` package.\n\nThe idea behind all of the models is always the same:\n\n1. Create the weighted projection of interest, e.g. `B <- A%*%t(A)`\n2. Generate random two-mode networks according to a given model.\n3. Compare if the values `B[i,j]` differ significantly from the distribution of values in the random projections.\n\nThe only difference in all models is the construction of the random two-mode networks which follow different rules:\n\n- **Fixed Degree Sequence Model** `fdsm()`: Create random two-mode networks with the same row and column sums as `A`.\n- **Fixed Column Model** `fixedcol()`: Create random two-mode networks with the same column sums as `A`.\n- **Fixed Row Model** `fixedrow()`: Create random two-mode networks with the same row sums as `A`.\n- **Fixed Fill Model** `fixedfill()`: Create random two-mode networks with the same number of ones as `A`.\n- **Stochastic Degree Sequence Model** `sdsm()`: Create random two-mode networks with *approximately* the same row and column sums as `A`.\n\nBefore we move to an actual use case, you may ask: So which model is the right one for me? That is actually quite a tricky question.\nThere is some guidance available [@neal2021comparing], but in general you can follow these rough guidelines:\n\n1. Use the model that fits you empirical setting or a known link formation process. If that link formation process dictates that row sums are fixed but column sums not, then choose `fixedow()`. \n2. Use `fdsm()` if your network is small enough. Sampling from the FDSM is quite expensive.\n3. Use the `sdsm()` for large networks.\n\nGiven that there is never a \"ground-truth\" binary projection, any choice of model is fine as long as it is motivated substantively and not merely because it fits the papers narrative best.\n\nTo illustrate model fitting in a substantive setting, we use a bill cosponsorship network from the U.S. Senate in 2015 (available in the `networkdata` package). The data form a two-mode network in which one set of nodes represents senators and the other represents bills; a tie between a senator and a bill indicates sponsorship or cosponsorship. We are interested in examining the binary one-mode projection onto senators, i.e. a network in which two senators are connected if they sponsored at least one bill together.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"cosponsor\")\ncosponsor\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nIGRAPH 6eddec8 UN-B 3984 26392 -- \n+ attr: name (v/c), type (v/l), party (v/c)\n+ edges from 6eddec8 (vertex names):\n [1] 115s1   --Enzi, Michael B.    115s10  --Cardin, Benjamin L.\n [3] 115s10  --Wicker, Roger F.    115s100 --Alexander, Lamar   \n [5] 115s1000--Franken, Al         115s1000--Murray, Patty      \n [7] 115s1000--Brown, Sherrod      115s1000--Warren, Elizabeth  \n [9] 115s1000--Markey, Edward J.   115s1001--Crapo, Mike        \n[11] 115s1001--Blumenthal, Richard 115s1001--Murphy, Christopher\n[13] 115s1001--Cassidy, Bill       115s1001--Alexander, Lamar   \n[15] 115s1001--Bennet, Michael F.  115s1002--Moran, Jerry       \n+ ... omitted several edges\n```\n\n\n:::\n:::\n\n\nBecause the resulting network is fairly large, we will rely on the SDSM (Stochastic Degree Sequence Model) for modeling. It is important to note that the implemented projection models automatically generate the one-mode projection for the node set where `type == FALSE`. If the goal is instead to project onto the nodes with `type == TRUE`, the `type` attribute must first be inverted. In other words, the coding of the bipartite membership determines which mode is projected by default, so care must be taken to ensure that the correct node set is being analyzed.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsenators <- sdsm(cosponsor, alpha = 0.05, signed = FALSE)\nsenators\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nIGRAPH 2e3e260 UN-- 110 1591 -- \n+ attr: name (v/c), party (v/c)\n+ edges from 2e3e260 (vertex names):\n [1] Enzi, Michael B.--Wicker, Roger F. Enzi, Michael B.--Alexander, Lamar\n [3] Enzi, Michael B.--Crapo, Mike      Enzi, Michael B.--Moran, Jerry    \n [5] Enzi, Michael B.--Scott, Tim       Enzi, Michael B.--Daines, Steve   \n [7] Enzi, Michael B.--Perdue, David    Enzi, Michael B.--Blunt, Roy      \n [9] Enzi, Michael B.--Inhofe, James M. Enzi, Michael B.--Barrasso, John  \n[11] Enzi, Michael B.--Fischer, Deb     Enzi, Michael B.--Ernst, Joni     \n[13] Enzi, Michael B.--Rounds, Mike     Enzi, Michael B.--Kennedy, John   \n[15] Enzi, Michael B.--Flake, Jeff      Enzi, Michael B.--Hoeven, John    \n+ ... omitted several edges\n```\n\n\n:::\n:::\n\n\nWith `signed = FALSE`, the procedure performs a one-tailed test for each edge that has a non-zero weight in the weighted projection. The output is a filtered (or “backbone”) projection that retains only those senator–senator ties whose co-sponsorship strength is significantly greater than expected in the null model at the chosen significance level (`alpha = 0.05`). In other words, the projection keeps unusually strong co-sponsorship relationships and discards ties that could plausibly arise from baseline activity levels alone.\n\nWhen `signed = TRUE`, the procedure performs a two-tailed test for every pair of nodes. This yields a signed backbone: positive edges indicate pairs that co-sponsor significantly more than expected, while negative edges indicate pairs that co-sponsor significantly less than expected under the same null model. The resulting projection is therefore a signed network (see @sec-signed-networks).\n\nThe figure below visualizes the backbone projection (restricted to the largest connected component) with nodes colored by party. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nV(senators)$party <- V(cosponsor)$party[match(\n  V(senators)$name,\n  V(cosponsor)$name\n)]\nsenators <- largest_component(senators)\nparty_cols <-\n  c(D = \"#104E8B\", R = \"#CD3333\", I = \"#EEB422\")\nggraph(senators, \"stress\") +\n  geom_edge_link0(edge_linewidth = 0.1, edge_color = \"grey66\") +\n  geom_node_point(shape = 21, aes(fill = party), size = 4) +\n  scale_fill_manual(values = party_cols) +\n  theme_graph() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](two-mode-networks_files/figure-html/cosponsor-plot-1.png){width=768}\n:::\n:::\n\n\nThe backbone projection reveals a strongly polarized cosponsorship structure. Nodes are senators, colored by party, and the layout places more strongly connected senators closer together. The most salient feature is the clear separation into two large clusters: a predominantly Republican cluster on the left (red) and a predominantly Democratic cluster on the right (blue). Within each party cluster, the network is very dense, indicating that many pairs of same-party senators cosponsor bills together at rates that are *significantly stronger than expected* given their overall cosponsorship activity (as captured by the SDSM null model).\n\nIn contrast, there are only a small number of edges spanning the gap between the two clusters. These cross-party ties represent relatively rare cases of unusually strong bipartisan cosponsorship. Senators positioned near the boundary between the clusters, and the few cross-cluster edges attached to them, can be interpreted as potential “broker-like” actors in this backbone, in the sense that they are among the limited set of senators whose cosponsorship patterns connect the two partisan blocs. The Independent senators (yellow) appear closer to one side but near the interface, consistent with the idea that independents often align with one coalition while occasionally participating in cross-party collaborations. Overall, the figure shows that once we filter the projection to retain only statistically meaningful ties, cosponsorship is dominated by within-party collaboration, with comparatively little bipartisan structure.\n\n## Notable Packages\n\n- `incidentally` to create random two-mode networks with given structural features\n",
    "supporting": [
      "two-mode-networks_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}